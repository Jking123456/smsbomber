<!DOCTYPE html>
<html>
<head>
    <title>RUDO Key Monitor</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { background: #000; color: #00ff41; font-family: monospace; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; border: 1px solid #333; }
        th, td { border: 1px solid #333; padding: 10px; text-align: left; }
        th { background: #111; }
    </style>
</head>
<body>
    <h1>> RUDO_DATABASE_LIVE</h1>
    <div id="status">Scanning tables...</div>
    <div id="display"></div>

    <script>
        async function loadData() {
            try {
                const res = await fetch('/api/key');
                const config = await res.json();
                const supabaseClient = supabase.createClient(config.url, config.anonKey);

                // Try common RUDO table names automatically
                const tables = ['keys', 'users', 'whitelist', 'vips'];
                let foundData = null;

                for (let name of tables) {
                    const { data, error } = await supabaseClient.from(name).select('*');
                    if (!error && data.length > 0) {
                        foundData = data;
                        document.getElementById('status').innerText = "CONNECTED TO TABLE: " + name;
                        break;
                    }
                }

                if (foundData) {
                    document.getElementById('display').innerHTML = `<pre>${JSON.stringify(foundData, null, 2)}</pre>`;
                } else {
                    document.getElementById('status').innerText = "Connected, but tables appear empty or names are different.";
                }
            } catch (e) {
                document.getElementById('status').innerText = "Error: " + e.message;
            }
        }
        loadData();
    </script>
</body>
</html>
